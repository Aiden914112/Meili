<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Momo O2O æ´¾å–®ç³»çµ±</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 80px; /* ç‚ºäº†é¿é–‹åº•éƒ¨å°èˆª */
        }
        
        /* éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .loader {
            border-top-color: #db2777;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        [v-cloak] { display: none; }
        
        /* æ¨¡æ“¬ iOS åº•éƒ¨å®‰å…¨å€åŸŸ */
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="app" v-cloak class="min-h-screen relative">
        
        <!-- ================= Header ================= -->
        <header class="bg-gradient-to-r from-pink-600 to-pink-500 text-white p-4 shadow-lg sticky top-0 z-50">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-lg font-bold tracking-wide">{{ pageTitle }}</h1>
                    <p class="text-xs opacity-90">
                        <span class="bg-white/20 px-2 py-0.5 rounded text-[10px] mr-1">{{ currentRoleName }}</span>
                        {{ liffProfile ? liffProfile.displayName : 'è¨ªå®¢' }}
                    </p>
                </div>
                <!-- é‡æ–°æ•´ç† (åƒ…åœ¨ä»»å‹™æˆ–å¤§å»³é¡¯ç¤º) -->
                <button v-if="['tasks', 'dispatch'].includes(currentTab)" @click="refreshData" :disabled="isLoading" class="p-2 bg-white/10 rounded-full hover:bg-white/20 active:scale-95 transition">
                    <svg v-if="!isLoading" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    <div v-else class="h-5 w-5 border-2 border-white/50 border-t-white rounded-full animate-spin"></div>
                </button>
            </div>
        </header>

        <!-- ================= Main Content ================= -->
        <main class="p-4 space-y-4">
            
            <!-- å…¨å±€éŒ¯èª¤æç¤º -->
            <div v-if="errorMessage" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-sm mb-4 text-sm">
                <p class="font-bold mb-1">ç³»çµ±æç¤º</p>
                <p>{{ errorMessage }}</p>
            </div>

            <!-- TAB 1: æˆ‘çš„ä»»å‹™ (å¸«å‚…ç«¯ - å·²æ¥å–®) -->
            <div v-if="currentTab === 'tasks'" class="space-y-4">
                <div v-if="myTasks.length === 0" class="flex flex-col items-center justify-center py-16 text-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mb-2 text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                    </svg>
                    <p>ç›®å‰æ²’æœ‰é€²è¡Œä¸­çš„ä»»å‹™</p>
                    <p class="text-xs mt-1">è«‹å‰å¾€ã€Œæ´¾å–®å¤§å»³ã€æ¥å–®</p>
                </div>

                <div v-for="order in myTasks" :key="order.id" class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="bg-pink-50 px-4 py-2 border-b border-pink-100 flex justify-between items-center">
                        <span class="text-pink-700 font-bold text-sm">{{ order.id }}</span>
                        <span class="text-xs text-gray-500 bg-white px-2 py-0.5 rounded-full border border-gray-200">å®‰è£ä¸­</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-gray-800 mb-1">{{ order.customerName }}</h3>
                        <p class="text-sm text-gray-500 mb-3 flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            {{ order.address }}
                        </p>
                        
                        <div class="bg-gray-50 rounded-lg p-3 mb-4 space-y-1">
                            <div class="flex justify-between text-xs">
                                <span class="text-gray-500">å•†å“æ©Ÿå‹</span>
                                <span class="font-medium text-gray-800">{{ order.model }}</span>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span class="text-gray-500">é ç´„æ™‚é–“</span>
                                <span class="font-medium text-pink-600">{{ order.job ? order.job.date : 'å¾…è¯ç¹«' }} ({{ order.job ? order.job.slot : '' }})</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <button class="flex items-center justify-center py-2 px-4 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50">
                                ğŸ“ è¯ç¹«
                            </button>
                            <button class="flex items-center justify-center py-2 px-4 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 shadow-md shadow-green-200">
                                âœ… å®Œå·¥å›å ±
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: æ´¾å–®å¤§å»³ (å€åŸŸ/ç¸½éƒ¨ - å¾…è™•ç†è¨‚å–®) -->
            <div v-if="currentTab === 'dispatch'" class="space-y-4">
                <!-- å€åŸŸç¯©é¸å™¨ (æ¼”ç¤ºç”¨) -->
                <div class="flex space-x-2 overflow-x-auto hide-scrollbar pb-2">
                    <button v-for="area in ['å…¨éƒ¨', 'å°åŒ—', 'å°ä¸­', 'é«˜é›„']" 
                        class="px-4 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors"
                        :class="currentArea === area ? 'bg-gray-800 text-white' : 'bg-white text-gray-600 border border-gray-200'">
                        {{ area }}
                    </button>
                </div>

                <div v-for="order in pendingOrders" :key="order.id" class="bg-white rounded-xl shadow-sm border border-l-4 border-l-orange-400 p-4 relative">
                    <div class="absolute top-4 right-4 text-xs font-bold text-orange-500 bg-orange-50 px-2 py-1 rounded">å¾…æ´¾å·¥</div>
                    
                    <div class="mb-2">
                        <span class="text-xs text-gray-400">è¨‚å–®æ™‚é–“: {{ formatDate(order.createdAt) }}</span>
                        <h3 class="font-bold text-gray-800">{{ order.id }}</h3>
                    </div>

                    <div class="space-y-1 mb-4">
                        <p class="text-sm text-gray-800"><span class="text-gray-400 text-xs mr-2">å®¢æˆ¶</span>{{ order.customerName }}</p>
                        <p class="text-sm text-gray-800"><span class="text-gray-400 text-xs mr-2">åœ°å€</span>{{ order.city }}</p>
                        <p class="text-sm text-gray-800"><span class="text-gray-400 text-xs mr-2">å•†å“</span>{{ order.model }}</p>
                    </div>

                    <button @click="dispatchOrder(order.id)" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2.5 rounded-lg text-sm font-bold shadow-md shadow-orange-100 flex justify-center items-center active:scale-95 transition">
                        æ¥å–® / æŒ‡æ´¾å¸«å‚…
                    </button>
                </div>
            </div>

            <!-- TAB 3: åº«å­˜æŸ¥è©¢ (ç®¡ç†å“¡ - ç¸½åº«å­˜) -->
            <div v-if="currentTab === 'inventory'" class="space-y-4">
                <div class="bg-white rounded-xl shadow-sm p-4">
                    <h3 class="font-bold text-gray-800 mb-4 border-b pb-2">ğŸ“¦ å³æ™‚åº«å­˜ç›£æ§</h3>
                    
                    <div class="space-y-4">
                        <div v-for="item in inventory" :key="item.model" class="flex justify-between items-center">
                            <div>
                                <p class="text-sm font-medium text-gray-800">{{ item.model }}</p>
                                <p class="text-xs text-gray-400">{{ item.brand }}</p>
                            </div>
                            <div class="text-right">
                                <span class="text-lg font-bold" :class="item.stock < item.alert ? 'text-red-600' : 'text-green-600'">
                                    {{ item.stock }}
                                </span>
                                <p class="text-[10px] text-gray-400">å®‰å…¨æ°´ä½: {{ item.alert }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-xs text-blue-700">
                    ğŸ’¡ æç¤ºï¼šåº«å­˜æ•¸é‡æœƒéš¨è‘—å¸«å‚…ã€Œå®Œå·¥å›å ±ã€è‡ªå‹•æ‰£é™¤ã€‚
                </div>
            </div>

            <!-- TAB 4: å€‹äººä¸­å¿ƒ (è§’è‰²åˆ‡æ›) -->
            <div v-if="currentTab === 'profile'" class="space-y-4">
                <div class="bg-white rounded-xl shadow-sm p-6 flex flex-col items-center">
                    <div class="w-20 h-20 bg-gray-200 rounded-full mb-3 overflow-hidden">
                        <img v-if="liffProfile && liffProfile.pictureUrl" :src="liffProfile.pictureUrl" class="w-full h-full object-cover">
                        <div v-else class="w-full h-full flex items-center justify-center text-gray-400 text-2xl">ğŸ‘¤</div>
                    </div>
                    <h2 class="font-bold text-xl">{{ liffProfile ? liffProfile.displayName : 'æœªç™»å…¥ä½¿ç”¨è€…' }}</h2>
                    <p class="text-sm text-gray-500 mb-6">ID: {{ liffProfile ? liffProfile.userId.substring(0,8)+'...' : '---' }}</p>

                    <div class="w-full border-t pt-4">
                        <p class="text-xs text-gray-400 mb-2 text-center">åˆ‡æ›æ¼”ç¤ºè§’è‰²</p>
                        <div class="grid grid-cols-3 gap-2">
                            <button @click="role = 'MASTER'" :class="role === 'MASTER' ? 'bg-pink-600 text-white' : 'bg-gray-100 text-gray-600'" class="py-2 rounded-lg text-xs font-medium transition">
                                ğŸ› ï¸ å¸«å‚…
                            </button>
                            <button @click="role = 'DISPATCH'" :class="role === 'DISPATCH' ? 'bg-pink-600 text-white' : 'bg-gray-100 text-gray-600'" class="py-2 rounded-lg text-xs font-medium transition">
                                ğŸ“¡ èª¿åº¦
                            </button>
                            <button @click="role = 'ADMIN'" :class="role === 'ADMIN' ? 'bg-pink-600 text-white' : 'bg-gray-100 text-gray-600'" class="py-2 rounded-lg text-xs font-medium transition">
                                ğŸ“Š ç®¡ç†
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="text-center text-gray-400 text-xs mt-8">
                    ç³»çµ±ç‰ˆæœ¬ v2.0 (Demo)<br>
                    Momo O2O Dispatch System
                </div>
            </div>

        </main>

        <!-- ================= Bottom Navigation ================= -->
        <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 safe-bottom shadow-[0_-2px_10px_rgba(0,0,0,0.05)] z-50">
            <div class="flex justify-around items-center h-16">
                
                <button @click="currentTab = 'tasks'" class="flex flex-col items-center justify-center w-full h-full space-y-1">
                    <svg class="w-6 h-6 transition-colors" :class="currentTab === 'tasks' ? 'text-pink-600' : 'text-gray-400'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                    </svg>
                    <span class="text-[10px] font-medium" :class="currentTab === 'tasks' ? 'text-pink-600' : 'text-gray-400'">æˆ‘çš„ä»»å‹™</span>
                </button>

                <button @click="currentTab = 'dispatch'" class="flex flex-col items-center justify-center w-full h-full space-y-1 relative">
                    <div v-if="pendingOrders.length > 0" class="absolute top-2 right-6 w-2 h-2 bg-red-500 rounded-full"></div>
                    <svg class="w-6 h-6 transition-colors" :class="currentTab === 'dispatch' ? 'text-pink-600' : 'text-gray-400'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                    </svg>
                    <span class="text-[10px] font-medium" :class="currentTab === 'dispatch' ? 'text-pink-600' : 'text-gray-400'">æ´¾å–®å¤§å»³</span>
                </button>

                <button @click="currentTab = 'inventory'" class="flex flex-col items-center justify-center w-full h-full space-y-1">
                    <svg class="w-6 h-6 transition-colors" :class="currentTab === 'inventory' ? 'text-pink-600' : 'text-gray-400'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                    </svg>
                    <span class="text-[10px] font-medium" :class="currentTab === 'inventory' ? 'text-pink-600' : 'text-gray-400'">åº«å­˜</span>
                </button>

                <button @click="currentTab = 'profile'" class="flex flex-col items-center justify-center w-full h-full space-y-1">
                    <svg class="w-6 h-6 transition-colors" :class="currentTab === 'profile' ? 'text-pink-600' : 'text-gray-400'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span class="text-[10px] font-medium" :class="currentTab === 'profile' ? 'text-pink-600' : 'text-gray-400'">æˆ‘çš„</span>
                </button>

            </div>
        </nav>

    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                // ================= é…ç½® =================
                // âš ï¸ è«‹å¡«å…¥æ­£ç¢ºçš„ ID (ä¸è¦æœ‰ä¸­æ–‡)
                const LIFF_ID = "2008639782-x840YeZq"; 
                const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbykD87A-5V5WvRMcGQxFYUZtjcaMWWUC6GjoiMZsmfyw9E6mOc8Y5EY6vZ1jxcJUNEKAg/exec';

                // ================= ç‹€æ…‹ =================
                const currentTab = ref('tasks');
                const role = ref('MASTER'); // MASTER, DISPATCH, ADMIN
                const currentArea = ref('å…¨éƒ¨');
                const isLoading = ref(false);
                const errorMessage = ref('');
                const liffProfile = ref(null);
                
                // æ¨¡æ“¬æ•¸æ“šåº« (ç‚ºäº† Demo é å…ˆå¡«å…¥)
                const mockOrders = ref([
                    { id: 'MOMO-8821', customerName: 'ç‹å°æ˜', city: 'å°åŒ—', address: 'å°åŒ—å¸‚å¤§å®‰å€å’Œå¹³æ±è·¯äºŒæ®µ', model: 'Dyson V12 Detect', status: 'ASSIGNED', createdAt: '2023-12-05T10:00:00' },
                    { id: 'MOMO-8825', customerName: 'æç¾è¯', city: 'å°ä¸­', address: 'å°ä¸­å¸‚è¥¿å±¯å€å°ç£å¤§é“ä¸‰æ®µ', model: 'LG PuriCare', status: 'PENDING', createdAt: '2023-12-06T09:30:00' },
                    { id: 'MOMO-8826', customerName: 'é™³å¤§æ–‡', city: 'é«˜é›„', address: 'é«˜é›„å¸‚å·¦ç‡Ÿå€åšæ„›äºŒè·¯', model: 'Roborock S8', status: 'PENDING', createdAt: '2023-12-06T11:15:00' },
                    { id: 'MOMO-8829', customerName: 'æ—å¿—è±ª', city: 'å°åŒ—', address: 'å°åŒ—å¸‚å…§æ¹–å€ç‘å…‰è·¯', model: 'Dyson V12 Detect', status: 'PENDING', createdAt: '2023-12-06T14:20:00' },
                ]);

                const mockInventory = ref([
                    { brand: 'Dyson', model: 'V12 Detect', stock: 5, alert: 10 },
                    { brand: 'LG', model: 'PuriCare 360', stock: 12, alert: 5 },
                    { brand: 'Roborock', model: 'S8 Pro Ultra', stock: 2, alert: 3 },
                ]);

                // ================= è¨ˆç®—å±¬æ€§ =================
                const pageTitle = computed(() => {
                    const titles = { 'tasks': 'æˆ‘çš„ä»»å‹™', 'dispatch': 'æ´¾å–®å¤§å»³', 'inventory': 'åº«å­˜æŸ¥è©¢', 'profile': 'å€‹äººä¸­å¿ƒ' };
                    return titles[currentTab.value];
                });

                const currentRoleName = computed(() => {
                    const roles = { 'MASTER': 'å¸«å‚…', 'DISPATCH': 'èª¿åº¦å“¡', 'ADMIN': 'ç®¡ç†å“¡' };
                    return roles[role.value];
                });

                // éæ¿¾å‡ºã€Œæˆ‘çš„ä»»å‹™ã€ (æ¨¡æ“¬: ç‹€æ…‹ç‚º ASSIGNED ä¸”æ˜¯æˆ‘çš„å–®)
                // ç‚ºäº† Demo æ–¹ä¾¿ï¼Œæˆ‘å€‘å‡è¨­æ‰€æœ‰ ASSIGNED çš„å–®éƒ½æ˜¯æˆ‘çš„
                const myTasks = computed(() => {
                    return mockOrders.value.filter(o => o.status === 'ASSIGNED');
                });

                // éæ¿¾å‡ºã€Œå¾…æ´¾å·¥ã€è¨‚å–®
                const pendingOrders = computed(() => {
                    return mockOrders.value.filter(o => o.status === 'PENDING');
                });

                const inventory = computed(() => mockInventory.value);

                // ================= æ–¹æ³• =================
                const callApi = async (action, payloadData = {}) => {
                    // DEMO æ¨¡å¼ï¼šå¦‚æœæ˜¯è®€å–è¨‚å–®ï¼Œæˆ‘å€‘æ··åˆä½¿ç”¨ Fake Data èˆ‡ API
                    if (action === 'GET_PENDING_ORDERS') {
                        // é€™è£¡å¯ä»¥é¸æ“‡çœŸçš„å»æ‰“ APIï¼Œæˆ–è€…ç›´æ¥å›å‚³ Mock
                        // ç‚ºäº†è®“æ‚¨å…ˆçœ‹åˆ°ç•«é¢ï¼Œæˆ‘å€‘å…ˆç”¨ Mock
                        return {}; // API å›å‚³ç©ºï¼Œæˆ‘å€‘ç”¨ Mock
                    }
                    
                    const payload = JSON.stringify({ action, data: payloadData });
                    const response = await fetch(GAS_API_URL, {
                        method: 'POST',
                        redirect: 'follow',
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        body: payload
                    });
                    const json = await response.json();
                    if (json.status === 'error') throw new Error(json.message);
                    return json.data;
                };

                const initLiff = async () => {
                    try {
                        if (LIFF_ID.startsWith("U")) { alert("LIFF ID éŒ¯èª¤"); return; }
                        await liff.init({ liffId: LIFF_ID });
                        if (!liff.isLoggedIn()) {
                            liff.login();
                        } else {
                            liffProfile.value = await liff.getProfile();
                        }
                    } catch (err) {
                        errorMessage.value = `LIFF Error: ${err.message}`;
                    }
                };

                const refreshData = async () => {
                    isLoading.value = true;
                    // æ¨¡æ“¬ç¶²è·¯å»¶é²
                    setTimeout(() => {
                        isLoading.value = false;
                        // é€™è£¡æœªä¾†æ¥æ­£å¼ API
                    }, 800);
                };

                const dispatchOrder = async (orderId) => {
                    // æ¼”ç¤ºé‚è¼¯ï¼šç›´æ¥å°‡ç‹€æ…‹æ”¹ç‚º ASSIGNED
                    if(!confirm('ç¢ºèªæ¥å–®ï¼Ÿ')) return;
                    
                    isLoading.value = true;
                    
                    // æ¨¡æ“¬ API å‘¼å«
                    setTimeout(() => {
                        const orderIndex = mockOrders.value.findIndex(o => o.id === orderId);
                        if (orderIndex !== -1) {
                            mockOrders.value[orderIndex].status = 'ASSIGNED';
                            // è‡ªå‹•è·³è½‰åˆ°æˆ‘çš„ä»»å‹™é ç±¤
                            currentTab.value = 'tasks';
                            alert('æ¥å–®æˆåŠŸï¼è«‹è‡³ã€Œæˆ‘çš„ä»»å‹™ã€æŸ¥çœ‹è©³æƒ…');
                        }
                        isLoading.value = false;
                    }, 500);
                };

                const formatDate = (val) => {
                    if (!val) return '';
                    const d = new Date(val);
                    return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;
                };

                onMounted(() => {
                    initLiff();
                });

                return { 
                    currentTab, role, currentArea, 
                    pageTitle, currentRoleName,
                    myTasks, pendingOrders, inventory,
                    liffProfile, isLoading, errorMessage,
                    refreshData, dispatchOrder, formatDate
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
